# ==============================================================================
# Ensemble Training Project - Dependencies
# ==============================================================================
# 安装方法: pip install -r requirements.txt
# 注意: 请先安装 PyTorch (见下方说明)
# ==============================================================================

# ------------------------------------------------------------------------------
# [核心依赖] 深度学习框架
# ------------------------------------------------------------------------------
# PyTorch - 请根据你的 CUDA 版本选择正确的安装命令:
# CUDA 11.8: pip install torch torchvision --index-url https://download.pytorch.org/whl/cu118
# CUDA 12.1: pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
# CPU only:  pip install torch torchvision --index-url https://download.pytorch.org/whl/cpu
torch>=2.0.0
torchvision>=0.15.0

# ------------------------------------------------------------------------------
# [核心依赖] 数据处理与科学计算
# ------------------------------------------------------------------------------
numpy>=1.21.0
scikit-learn>=1.0.0           # OOD 评估 (roc_auc_score)
scikit-image>=0.19.0          # imagecorruptions 依赖
Pillow>=9.0.0                 # 图像处理

# ------------------------------------------------------------------------------
# [核心依赖] 配置与日志
# ------------------------------------------------------------------------------
PyYAML>=6.0                   # YAML 配置文件解析
rich>=12.0.0                  # 美化控制台输出与进度条
tqdm>=4.64.0                  # 数据加载进度条

# ------------------------------------------------------------------------------
# [可选依赖] 实验跟踪
# ------------------------------------------------------------------------------
wandb>=0.13.0                 # Weights & Biases 实验跟踪 (可选, 由 use_wandb 控制)

# ------------------------------------------------------------------------------
# [可选依赖] Grad-CAM 可视化
# ------------------------------------------------------------------------------
grad-cam>=1.4.0       # GradCAM 热力图分析 (eval_run_gradcam=true 时需要)

# ------------------------------------------------------------------------------
# [可选依赖] Corruption 数据集生成
# ------------------------------------------------------------------------------
imagecorruptions>=1.1.2       # Corruption 鲁棒性数据生成

# ------------------------------------------------------------------------------
# [可选依赖] OOD 数据集生成 (SDXL Lightning)
# ------------------------------------------------------------------------------
# 以下依赖仅在运行 OOD 数据生成时需要:
# python -m ensemble.datasets.robustness.generate --type ood --dataset cifar10
diffusers>=0.21.0             # Stable Diffusion 管线
safetensors>=0.3.0            # 模型权重加载
accelerate>=0.20.0            # Diffusers 加速
transformers>=4.30.0          # CLIP 文本编码器
xformers>=0.0.20              # 显存优化 (可选但推荐)

# ------------------------------------------------------------------------------
# [Windows 特别说明]
# ------------------------------------------------------------------------------
# 1. 如果遇到 xformers 安装问题, 可以跳过它 (会稍微降低 OOD 生成速度)
# 2. imagecorruptions 可能需要 Visual C++ Build Tools:
#    https://visualstudio.microsoft.com/visual-cpp-build-tools/
# 3. num_workers > 0 在 Windows 上可能需要在代码入口添加:
#    if __name__ == '__main__':
#        # your code here
# ------------------------------------------------------------------------------
